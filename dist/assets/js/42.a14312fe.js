(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{570:function(s,a,n){"use strict";n.r(a);var t=n(6),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_1-部署环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-部署环境"}},[s._v("#")]),s._v(" 1.部署环境")]),s._v(" "),n("p",[s._v("数据库：MySQL 5.7.x  （相比5.5，5.6而言，5.7同步性能更好，支持多源复制，可实现多主一从，主从库版本应保证一致）\n操作系统：CentOS 7.x")]),s._v(" "),n("h2",{attrs:{id:"_2-配置约束"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置约束"}},[s._v("#")]),s._v(" 2.配置约束")]),s._v(" "),n("p",[s._v("主从库必须保证网络畅通可访问\n主库必须开启binlog日志\n主从库的server-id必须不同")]),s._v(" "),n("h2",{attrs:{id:"_3-主库配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-主库配置"}},[s._v("#")]),s._v(" 3.主库配置")]),s._v(" "),n("p",[s._v("配置/etc/my.cnf，my.cnf默认在/etc/下")]),s._v(" "),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# For advice on how to change settings please see")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token header"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("mysqld")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # and set to the amount of RAM for the most important data")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# innodb_buffer_pool_size = 128M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # to turn on a very important data integrity option: logging")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# changes to the binary log between backups.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log_bin")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # to set options mainly useful for reporting servers.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The server defaults are faster for transactions and fast SELECTs.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Adjust sizes as needed, experiment to find the optimal values.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# join_buffer_size = 128M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sort_buffer_size = 2M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# read_rnd_buffer_size = 2M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("datadir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/var/lib/mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("socket")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/var/lib/mysql/mysql.sock")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Disabling symbolic-links is recommended to prevent assorted security risks")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("symbolic-links")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("log-error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/var/log/mysqld.log")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pid-file")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/var/run/mysqld/mysqld.pid")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#slave-skip-errors=all #跳过所有错误")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("server-id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("128")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("master_info_repository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("table")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("relay_log_info_repository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("table")]),s._v("\t\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("log_bin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("mysql-bin \t#开启及设置二进制日志文件名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("binlog_format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("MIXED")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("sync_binlog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("expire_logs_days")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("7 #二进制日志自动删除/过期的天数。默认值为0，表示不自动删除。")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("binlog-do-db")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("mytest \t#要同步的数据库")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("binlog-ignore-db")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("mysql \t #不需要同步的数据库")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("binlog_ignore_db")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("information_schema")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("binlog_ignore_db")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("performation_schema")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("binlog_ignore_db")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("sys")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#explicit_defaults_for_timestamp=true")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br")])]),n("h3",{attrs:{id:"_3-1-创建授权用户"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-创建授权用户"}},[s._v("#")]),s._v(" 3.1 创建授权用户")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> grant replication slave on *.* to 'slave'@'%' identified by '123456';\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_3-2查看master状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2查看master状态"}},[s._v("#")]),s._v(" 3.2查看master状态")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> show master status \\G;\n*************************** 1. row ***************************\n             File: mysql-bin.000018\n         Position: 6800\n     Binlog_Do_DB: lm_policy_info\n Binlog_Ignore_DB: mysql,information_schema,performation_schema,sys\nExecuted_Gtid_Set: \n1 row in set (0.01 sec)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"_4-从库配置及操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-从库配置及操作"}},[s._v("#")]),s._v(" 4.从库配置及操作")]),s._v(" "),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token header"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("client")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("port")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("3306")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("default-character-set")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("utf8mb4")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token header"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("mysql")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("port")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("3306")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("default-character-set")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("utf8mb4")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token header"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("mysqld")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##########################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# summary")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##########################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#bind-address = 0.0.0.0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#port = 3306")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#datadir=/datavol/mysql/data \t#数据存储目录")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##########################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log bin")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##########################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("server-id")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("10345")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("master_info_repository")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("table")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("relay_log_info_repository")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("table")]),s._v("\t\t\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##########################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# character set")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##########################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("character-set-server")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("utf8mb4")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("collation-server")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("utf8mb4_unicode_ci")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("h3",{attrs:{id:"_4-1-设置【主库】信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-设置【主库】信息"}},[s._v("#")]),s._v(" 4.1 设置【主库】信息")]),s._v(" "),n("p",[n("code",[s._v("mysql -uroot -p")]),s._v("登录，进入mysql命令行")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> stop slave;\nQuery OK, 0 rows affected\n\nmysql> CHANGE MASTER TO \nMASTER_HOST='192.168.10.212',  #主库的ip\nMASTER_PORT=4300,  #主库的端口\nMASTER_USER='slave', #创建的有同步复制权限授权用户\nMASTER_PASSWORD='123456',  #创建的有同步复制权限授权用户密码\n#【关键处】从主库的该log_bin文件开始读取同步信息，主库show master status返回结果\nMASTER_LOG_FILE='mysql-bin.0000018', \n#【关键处】从文件中指定位置开始读取，主库show master status返回结果\nMASTER_LOG_POS=438 \nfor channel '300';\nQuery OK, 0 rows affected\n\n\nmysql>  start slave;\nQuery OK, 0 rows affected (0.00 sec)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("h3",{attrs:{id:"_4-2-查看同步信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-查看同步信息"}},[s._v("#")]),s._v(" 4.2 查看同步信息")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql>  show slave status \\G;\n*************************** 1. row ***************************\n               Slave_IO_State: Waiting for master to send event\n                  Master_Host: 192.168.1.128\n                  Master_User: slave\n                  Master_Port: 3306\n                Connect_Retry: 60\n              Master_Log_File: mysql-bin.000018\n          Read_Master_Log_Pos: 6800\n               Relay_Log_File: localhost-relay-bin-300.000002\n                Relay_Log_Pos: 320\n        Relay_Master_Log_File: mysql-bin.000018\n             Slave_IO_Running: Yes\n            Slave_SQL_Running: Yes\n              Replicate_Do_DB: \n          Replicate_Ignore_DB: \n           Replicate_Do_Table: \n       Replicate_Ignore_Table: \n      Replicate_Wild_Do_Table: \n  Replicate_Wild_Ignore_Table: \n                   Last_Errno: 0\n                   Last_Error: \n                 Skip_Counter: 0\n          Exec_Master_Log_Pos: 6800\n              Relay_Log_Space: 535\n              Until_Condition: None\n               Until_Log_File: \n                Until_Log_Pos: 0\n           Master_SSL_Allowed: No\n           Master_SSL_CA_File: \n           Master_SSL_CA_Path: \n              Master_SSL_Cert: \n            Master_SSL_Cipher: \n               Master_SSL_Key: \n        Seconds_Behind_Master: 0\nMaster_SSL_Verify_Server_Cert: No\n                Last_IO_Errno: 0\n                Last_IO_Error: \n               Last_SQL_Errno: 0\n               Last_SQL_Error: \n  Replicate_Ignore_Server_Ids: \n             Master_Server_Id: 128\n                  Master_UUID: b806bdaa-5ad7-11eb-9ddd-000c29ff7584\n             Master_Info_File: mysql.slave_master_info\n                    SQL_Delay: 0\n          SQL_Remaining_Delay: NULL\n      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates\n           Master_Retry_Count: 86400\n                  Master_Bind: \n      Last_IO_Error_Timestamp: \n     Last_SQL_Error_Timestamp: \n               Master_SSL_Crl: \n           Master_SSL_Crlpath: \n           Retrieved_Gtid_Set: \n            Executed_Gtid_Set: 8f9e146f-0a18-11e7-810a-0050568833c8:1-4\n                Auto_Position: 0\n         Replicate_Rewrite_DB: \n                 Channel_Name: 300\n           Master_TLS_Version: \n1 row in set (0.00 sec)\n\nERROR: \nNo query specified\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br")])]),n("p",[s._v("可以看见设置三个的主从同步通道的所有状态信息。\n只有【Slave_IO_Running】和【Slave_SQL_Running】都是Yes，则同步是正常的。\n如果是No或者Connecting都不行，可查看mysql-error.log，以排查问题。")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql>  show variables like 'log_error%';\n+---------------------+---------------------+\n| Variable_name       | Value               |\n+---------------------+---------------------+\n| log_error           | /var/log/mysqld.log |\n| log_error_verbosity | 3                   |\n+---------------------+---------------------+\n2 rows in set (0.01 sec)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("配置完成，则【从库10345】开始自动同步。")]),s._v(" "),n("p",[s._v("若需要单独启动或停止某个同步通道，可使用如下命令：\nstart slave for channel '300';   //启动名称为300的同步通道\nstop slave for channel '300';   //停止名称为300的同步通道")]),s._v(" "),n("h2",{attrs:{id:"提示"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#提示"}},[s._v("#")]),s._v(" 提示")]),s._v(" "),n("p",[s._v("在设置同步之前的数据是没有同步的，只有在设置同步后，你在主库操作的数据都会同步到从库。")]),s._v(" "),n("p",[s._v("来源于："),n("a",{attrs:{href:"https://my.oschina.net/u/2399373/blog/2878650?origin=wechat",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);